<!doctype html>
<script>
  (function () {
    const p = new URLSearchParams(location.search);
    if (p.get("m") !== "2") return;

    const h = p.get("h");
    if (!h) return;

    let b64 = h.replace(/-/g, "+").replace(/_/g, "/");
    const pad = b64.length % 4;
    if (pad) b64 += "=".repeat(4 - pad);
    const bin = atob(b64);
    const bytes = new Uint8Array(bin.length);
    for (let i = 0; i < bin.length; i++) bytes[i] = bin.charCodeAt(i);
    const html = new TextDecoder().decode(bytes);

//document.body.hidden = true;
//document.documentElement.setAttribute("m2", "");

        // innerHTML ã§ç½®ãæ›ãˆï¼ˆdocument.open ã¯ä½¿ã‚ãªã„ï¼‰
        const render = () => {
          document.documentElement.innerHTML = html;

          // â˜… innerHTML ã§ã¯ <script> ãŒå®Ÿè¡Œã•ã‚Œãªã„ãŸã‚ã€ä½œã‚Šç›´ã—ã¦å®Ÿè¡Œã•ã›ã‚‹
          const scripts = Array.from(document.querySelectorAll("script"));
          for (const old of scripts) {
            const s = document.createElement("script");
            // å±æ€§ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆtype, src, nomodule, async, defer, integrity, crossorigin ãªã©ï¼‰
            for (const { name, value } of Array.from(old.attributes)) {
              s.setAttribute(name, value);
            }
            // ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ¬æ–‡ã‚’ã‚³ãƒ”ãƒ¼
            if (!old.src) s.textContent = old.textContent || "";
            old.replaceWith(s);
          }
        };
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", render, { once: true });
        } else {
          render();
        }
  })();
</script>

<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HTML â†’ URL å¤‰æ›ãƒ„ãƒ¼ãƒ«</title>
  <meta name="color-scheme" content="light" />
  <style>html[m2] body { display:none !important; }
    :root{
      --bg:#fff3db;           /* ã‚¯ãƒªãƒ¼ãƒ  */
      --card:#fffaf0;
      --ink:#2b241a;
      --muted:#6b5b47;
      --line:rgba(43,36,26,.14);
      --shadow: 0 18px 50px rgba(43,36,26,.14);
      --shadow2: 0 8px 22px rgba(43,36,26,.10);
      --accent:#c06a2b;
      --accent2:#8b4a1f;
      --good:#2b7a3d;
      --warn:#8a4b1f;
      --radius:18px;
      --radius2:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(900px 400px at 20% 5%, rgba(192,106,43,.12), transparent 60%),
        radial-gradient(700px 380px at 85% 15%, rgba(139,74,31,.12), transparent 60%),
        linear-gradient(180deg, var(--bg), #fff0d4 55%, #ffe7c0);
    }
    .wrap{
      max-width:1080px;
      margin:0 auto;
      padding:28px 16px 44px;
    }
    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    .brand{
      display:flex; gap:12px; align-items:center;
    }
    .logo{
      width:44px;height:44px;border-radius:14px;
      background:linear-gradient(135deg, rgba(192,106,43,.95), rgba(139,74,31,.95));
      box-shadow: var(--shadow2);
      position:relative;
      overflow:hidden;
    }
    .logo:before{
      content:"";
      position:absolute; inset:-30%;
      background:radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%);
      transform:rotate(12deg);
    }
    h1{
      margin:0;
      font-size:20px;
      letter-spacing:.2px;
    }
    .sub{
      margin:4px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.4;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(255,255,255,.55);
      box-shadow: 0 6px 18px rgba(43,36,26,.07);
      font-size:12.5px;
      color:var(--muted);
      white-space:nowrap;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:14px;
    }
    @media (max-width: 920px){
      .grid{grid-template-columns:1fr}
      header{flex-direction:column; align-items:stretch}
      .pill{justify-content:center}
    }
    .card{
      background:rgba(255,255,255,.62);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
    }
    .card .hd{
      padding:14px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,.72), rgba(255,255,255,.52));
    }
    .title{
      display:flex; flex-direction:column; gap:2px;
    }
    .title b{font-size:13.5px}
    .title span{font-size:12px;color:var(--muted)}
    .body{padding:14px 16px 16px}
    textarea{
      width:100%;
      min-height:340px;
      resize:vertical;
      padding:14px 14px;
      border-radius:var(--radius2);
      border:1px solid rgba(43,36,26,.18);
      outline:none;
      background:rgba(255,255,255,.78);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.7);
      font-family: var(--mono);
      font-size:12.8px;
      line-height:1.55;
      color:#2a2319;
    }
    textarea:focus{
      border-color: rgba(192,106,43,.55);
      box-shadow: 0 0 0 4px rgba(192,106,43,.16), inset 0 1px 0 rgba(255,255,255,.7);
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:12px;
    }
    .btn{
      border:none;
      border-radius:999px;
      padding:11px 14px;
      font-weight:600;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:9px;
      transition: transform .06s ease, box-shadow .12s ease, background .12s ease, opacity .12s ease;
      user-select:none;
    }
    .btn:active{transform: translateY(1px)}
    .btn.primary{
      background:linear-gradient(135deg, rgba(192,106,43,.96), rgba(139,74,31,.96));
      color:#fff;
      box-shadow: 0 12px 26px rgba(192,106,43,.24);
    }
    .btn.primary:hover{box-shadow: 0 14px 30px rgba(192,106,43,.30)}
    .btn.ghost{
      background:rgba(255,255,255,.72);
      color:var(--ink);
      border:1px solid rgba(43,36,26,.16);
      box-shadow: 0 10px 20px rgba(43,36,26,.08);
    }
    .btn.ghost:hover{box-shadow: 0 12px 24px rgba(43,36,26,.10)}
    .btn.warn{
      background:rgba(255,255,255,.70);
      color:var(--warn);
      border:1px solid rgba(138,75,31,.22);
    }
    .btn:disabled{opacity:.55; cursor:not-allowed}
    .hint{
      font-size:12px;
      color:var(--muted);
      line-height:1.55;
      margin-top:10px;
    }
    .mono{
      font-family: var(--mono);
      font-size:12.2px;
    }
    .out{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .field{
      width:100%;
      padding:12px 12px;
      border-radius:var(--radius2);
      border:1px solid rgba(43,36,26,.18);
      background:rgba(255,255,255,.78);
      outline:none;
      font-family: var(--mono);
      font-size:12.2px;
      line-height:1.4;
      word-break:break-all;
      min-height:84px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.7);
    }
    .status{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(43,36,26,.14);
      background:rgba(255,255,255,.55);
      color:var(--muted);
      font-size:12.5px;
      line-height:1.45;
    }
    .status.ok{border-color: rgba(43,122,61,.22); color: var(--good)}
    .status.warn{border-color: rgba(138,75,31,.22); color: var(--warn)}
    .kpi{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .kpi .box{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(43,36,26,.14);
      background:rgba(255,255,255,.55);
      font-size:12.5px;
      color:var(--muted);
    }
    .kpi b{color:var(--ink)}
    .footer{
      margin-top:14px;
      font-size:12px;
      color:rgba(43,36,26,.55);
      text-align:center;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:9px 10px;
      border-radius:999px;
      border:1px solid rgba(43,36,26,.14);
      background:rgba(255,255,255,.55);
      font-size:12px;
      color:var(--muted);
      margin-top:10px;
      flex-wrap:wrap;
    }
    .chip code{
      font-family:var(--mono);
      font-size:11.8px;
      color:#3b2f21;
      background:rgba(255,255,255,.55);
      padding:2px 6px;
      border-radius:8px;
      border:1px solid rgba(43,36,26,.10);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>HTML ã‚’ URL ã«å¤‰æ›</h1>
          <p class="sub">ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ â†’ URL ã‚’ç”Ÿæˆï¼†ã‚³ãƒ”ãƒ¼ã€‚<span class="mono">m=1</span>ã§ã‚³ãƒ¼ãƒ‰å¾©å…ƒã€<span class="mono">m=2</span>ã§è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ã€‚</p>
        </div>
      </div>
      <div class="pill" title="ä½¿ã„æ–¹ã®è¦ç‚¹">
        <span>ğŸ“Œ</span>
        <span><span class="mono">?m=1&amp;h=...</span>ï¼šã‚³ãƒ¼ãƒ‰è¡¨ç¤º / <span class="mono">?m=2&amp;h=...</span>ï¼šHTMLè¡¨ç¤º</span>
      </div>
    </header>

    <div class="grid">
      <!-- Left: Editor -->
      <section class="card" aria-label="HTMLå…¥åŠ›">
        <div class="hd">
          <div class="title">
            <b>HTML ã‚’å…¥åŠ›</b>
            <span>ï¼ˆä¿å­˜ãªã— / ãƒ­ãƒ¼ã‚«ãƒ«ã ã‘ã§å‹•ä½œï¼‰</span>
          </div>
          <button class="btn ghost" id="btnSample" type="button">âœ¨ ã‚µãƒ³ãƒ—ãƒ«æŒ¿å…¥</button>
        </div>
        <div class="body">
          <textarea id="htmlInput" spellcheck="false" placeholder="ã“ã“ã« HTML ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„â€¦"></textarea>

          <div class="row">
            <button class="btn primary" id="btnMakeUrl" type="button">ğŸ”— URL ã‚’ã‚³ãƒ”ãƒ¼</button>
            <button class="btn ghost" id="btnCopyOnly" type="button" style="display: none;">ğŸ“‹ è¡¨ç¤ºä¸­URLã ã‘ã‚³ãƒ”ãƒ¼</button>
            <button class="btn warn" id="btnOpenPreview" type="button" style="display: none;">ğŸªŸ è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ã§é–‹ãï¼ˆm=2ï¼‰</button>
            <button class="btn ghost" id="btnClear" type="button">ğŸ§¹ ã‚¯ãƒªã‚¢</button>
          </div>

          <div class="hint">
            â€» URL ã¯é•·ããªã‚Šã¾ã™ã€‚é•·ã™ãã‚‹å ´åˆã¯è²¼ã‚Šä»˜ã‘å…ˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶/ã‚¢ãƒ—ãƒª/å…±æœ‰å…ˆï¼‰ã§æ‰±ãˆãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚<br>
            â€» <span class="mono">m=2</span> ã®è¡¨ç¤ºã¯ã€ŒåŒã˜ã‚¿ãƒ–ã§ç½®ãæ›ãˆã€æ–¹å¼ã§ã™ï¼ˆæˆ»ã‚‹ã§æˆ»ã‚Œã¾ã™ï¼‰ã€‚ã†ã¾ãã„ã‹ãªã„å ´åˆã¯æ–°è¦ã‚¿ãƒ–ã§ã‚‚é–‹ã‘ã¾ã™ã€‚
          </div>

          <div class="chip">
            ä¾‹ï¼š
            <code>ï¼ˆé€šå¸¸ï¼‰ /tool.html</code>
            <code>?m=1&amp;h=...</code>
            <code>?m=2&amp;h=...</code>
          </div>
        </div>
      </section>

      <!-- Right: Output -->
      <section class="card" aria-label="URLå‡ºåŠ›">
        <div class="hd">
          <div class="title">
            <b>ç”Ÿæˆã•ã‚ŒãŸ URL</b>
            <span>ã‚³ãƒ”ãƒ¼æ¸ˆã¿è¡¨ç¤º &amp; é•·ã•ãƒã‚§ãƒƒã‚¯</span>
          </div>
        </div>
        <div class="body out">
          <div id="status" class="status">ã¾ã  URL ã¯ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</div>

          <div id="urlField" class="field" aria-label="URLè¡¨ç¤º" role="textbox" aria-multiline="true"></div>

          <div class="kpi">
            <div class="box"><b>HTMLæ–‡å­—æ•°</b><div id="kpiHtml">0</div></div>
            <div class="box"><b>URLæ–‡å­—æ•°</b><div id="kpiUrl">0</div></div>
          </div>

          <div class="hint mono">
            å¾©å…ƒï¼ˆm=1ï¼‰: ã“ã®ãƒšãƒ¼ã‚¸ã§ã‚³ãƒ¼ãƒ‰ãŒ textarea ã«å…¥ã‚Šã¾ã™ã€‚<br>
            è¡¨ç¤ºï¼ˆm=2ï¼‰: HTML ã‚’ãã®ã¾ã¾è¡¨ç¤ºã—ã¾ã™ï¼ˆãƒ„ãƒ¼ãƒ«UIã¯ç½®ãæ›ã‚ã‚Šã¾ã™ï¼‰ã€‚
          </div>
        </div>
      </section>
    </div>

    <div class="footer">Â© HTML â†’ URL Converter (Single-file)</div>
  </div>

  <script>
    // ---------------------------
    // Base64URL encode/decode (UTF-8 safe)
    // ---------------------------
    function toBase64Url(str) {
      const utf8 = new TextEncoder().encode(str);
      let bin = "";
      for (let i = 0; i < utf8.length; i++) bin += String.fromCharCode(utf8[i]);
      const b64 = btoa(bin);
      return b64.replace(/\+/g, "-").replace(/\//g, "_").replace(/=+$/g, "");
    }

    function fromBase64Url(b64url) {
      let b64 = b64url.replace(/-/g, "+").replace(/_/g, "/");
      const pad = b64.length % 4;
      if (pad) b64 += "=".repeat(4 - pad);
      const bin = atob(b64);
      const bytes = new Uint8Array(bin.length);
      for (let i = 0; i < bin.length; i++) bytes[i] = bin.charCodeAt(i);
      return new TextDecoder().decode(bytes);
    }

    async function copyText(text) {
      try {
        await navigator.clipboard.writeText(text);
        return true;
      } catch (e) {
        // Fallback
        try {
          const ta = document.createElement("textarea");
          ta.value = text;
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          ta.style.top = "-9999px";
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          const ok = document.execCommand("copy");
          document.body.removeChild(ta);
          return ok;
        } catch (_) {
          return false;
        }
      }
    }

    function setStatus(kind, msg) {
      const el = document.getElementById("status");
      el.className = "status" + (kind ? " " + kind : "");
      el.textContent = msg;
    }

    function setUrlField(url) {
      document.getElementById("urlField").textContent = url || "";
      document.getElementById("btnCopyOnly").disabled = !url;
      document.getElementById("btnOpenPreview").disabled = !url;
      document.getElementById("kpiUrl").textContent = String(url ? url.length : 0);
    }

    function updateHtmlKpi() {
      const html = document.getElementById("htmlInput").value || "";
      document.getElementById("kpiHtml").textContent = String(html.length);
    }

    function makeUrl(mode, html) {
      // åŒã˜ãƒšãƒ¼ã‚¸URLã‚’ãƒ™ãƒ¼ã‚¹ã«ã™ã‚‹ï¼ˆã‚¯ã‚¨ãƒªãƒ»ãƒãƒƒã‚·ãƒ¥ã¯é™¤å»ï¼‰
      const base = location.origin + location.pathname;
      const h = toBase64Url(html);
      const u = new URL(base);
      u.searchParams.set("m", String(2));
      u.searchParams.set("h", h);
      return u.toString();
    }

    function openInThisTabAsHtml(html) {
      // m=2 è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆãã®ã‚¿ãƒ–ã§é–‹ãï¼‰
      // æ³¨æ„: ãƒ„ãƒ¼ãƒ«UIã¯ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™
      //document.open();
      //document.write(html);
     // document.close();

    }

    // ---------------------------
    // Mode handling on load
    // ---------------------------
    (function initFromUrl() {
      const params = new URLSearchParams(location.search);
      const m = params.get("m");
      const h = params.get("h");

      // ã¾ãšã¯ KPI æ›´æ–°
      updateHtmlKpi();

      if (!m) {
        // æ™®é€šã«é–‹ã
        setStatus("", "ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã£ã¦ã€ŒURL ã‚’ã‚³ãƒ”ãƒ¼ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚");
        return;
      }

      if (!h) {
        setStatus("warn", "m ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã™ãŒã€hï¼ˆHTMLãƒ‡ãƒ¼ã‚¿ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚");
        return;
      }

      let html = "";
      try {
        html = fromBase64Url(h);
      } catch (e) {
        setStatus("warn", "URL ã® hï¼ˆHTMLãƒ‡ãƒ¼ã‚¿ï¼‰ã®å¾©å…ƒã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
        return;
      }

      if (m === "1") {
        // URLã‹ã‚‰HTMLã‚³ãƒ¼ãƒ‰ã‚’textareaã«è¡¨ç¤º
        const input = document.getElementById("htmlInput");
        input.value = html;
        updateHtmlKpi();
        setStatus("ok", "m=1ï¼šURL ã‹ã‚‰ HTML ã‚’å¾©å…ƒã—ã¾ã—ãŸã€‚å¿…è¦ãªã‚‰ç·¨é›†ã—ã¦ URL ã‚’å†ç”Ÿæˆã§ãã¾ã™ã€‚");
        // ã¤ã„ã§ã«ç¾åœ¨URLã‚‚è¡¨ç¤º
        setUrlField(location.href);
        return;
      }

      /*if (m === "2") {
        // URLã‹ã‚‰HTMLã‚’è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆåŒã‚¿ãƒ–ç½®æ›ï¼‰
        openInThisTabAsHtml(html);
        return;
      }*/

      setStatus("warn", "æœªçŸ¥ã® m ã§ã™ã€‚m=1 ã¾ãŸã¯ m=2 ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚");
    })();

    // ---------------------------
    // UI events
    // ---------------------------
    const htmlInput = document.getElementById("htmlInput");
    htmlInput.addEventListener("input", updateHtmlKpi);

    document.getElementById("btnSample").addEventListener("click", () => {
      const sample =
`<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ã‚µãƒ³ãƒ—ãƒ«</title>
  <style>
    body{font-family:system-ui;margin:0;background:#fff3db;color:#2b241a}
    .box{max-width:720px;margin:48px auto;padding:20px;background:rgba(255,255,255,.7);border-radius:18px;border:1px solid rgba(43,36,26,.14)}
    h1{margin:0 0 8px}
    p{margin:0;color:rgba(43,36,26,.7)}
    button{margin-top:14px;padding:10px 14px;border-radius:999px;border:0;background:#c06a2b;color:#fff;font-weight:700}
  </style>
</head>
<body>
  <div class="box">
    <h1>ã“ã‚“ã«ã¡ã¯ï¼</h1>
    <p>ã“ã‚Œã¯ URL ã«åŸ‹ã‚è¾¼ã¾ã‚ŒãŸ HTML ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>
    <button onclick="alert('OK!')">ã‚¯ãƒªãƒƒã‚¯</button>
  </div>
</body>
</html>`;
      htmlInput.value = sample;
      updateHtmlKpi();
      setStatus("", "ã‚µãƒ³ãƒ—ãƒ«ã‚’æŒ¿å…¥ã—ã¾ã—ãŸã€‚URL ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚");
    });

    document.getElementById("btnClear").addEventListener("click", () => {
      htmlInput.value = "";
      updateHtmlKpi();
      setUrlField("");
      setStatus("", "ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚");
    });

    document.getElementById("btnMakeUrl").addEventListener("click", async () => {
      const html = htmlInput.value || "";
      if (!html.trim()) {
        setStatus("warn", "HTML ãŒç©ºã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚");
        return;
      }

      const url = makeUrl(1, html); // m=1 ã‚’ç”Ÿæˆï¼ˆå¾©å…ƒãƒ¢ãƒ¼ãƒ‰ï¼‰
      setUrlField(url);

      // é•·ã•ç›®å®‰ï¼ˆç’°å¢ƒä¾å­˜ï¼‰
      const len = url.length;
      let msg = "URL ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚ã‚³ãƒ”ãƒ¼ã—ã¦ã„ã¾ã™â€¦";
      let kind = "ok";
      if (len > 7000) { kind = "warn"; msg = "URL ãŒã‹ãªã‚Šé•·ã„ã§ã™ï¼ˆå…±æœ‰å…ˆã§æ‰±ãˆãªã„å¯èƒ½æ€§ï¼‰ã€‚ã‚³ãƒ”ãƒ¼ã¯è©¦ã¿ã¾ã™ã€‚"; }
      else if (len > 3000) { kind = "warn"; msg = "URL ãŒé•·ã‚ã§ã™ã€‚è²¼ã‚Šä»˜ã‘å…ˆã§å‹•ä½œç¢ºèªã‚’æ¨å¥¨ã—ã¾ã™ã€‚"; }

      const ok = await copyText(url);
      if (ok) setStatus(kind, msg + "ï¼ˆã‚³ãƒ”ãƒ¼å®Œäº†ï¼‰");
      else setStatus("warn", "URL ã¯ç”Ÿæˆã•ã‚Œã¾ã—ãŸãŒã€ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚");
    });

    document.getElementById("btnCopyOnly").addEventListener("click", async () => {
      const url = document.getElementById("urlField").textContent.trim();
      if (!url) return;
      const ok = await copyText(url);
      if (ok) setStatus("ok", "è¡¨ç¤ºä¸­ã® URL ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚");
      else setStatus("warn", "ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚");
    });

    document.getElementById("btnOpenPreview").addEventListener("click", () => {
      const html = htmlInput.value || "";
      if (!html.trim()) {
        setStatus("warn", "HTML ãŒç©ºã§ã™ã€‚");
        return;
      }
      const url2 = makeUrl(2, html); // m=2 è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰URL
      // ã¾ãšåŒã‚¿ãƒ–ï¼ˆè¦ä»¶ï¼‰
      try {
        location.href = url2;
      } catch (e) {
        // ãƒ€ãƒ¡ãªã‚‰æ–°ã‚¿ãƒ–
        window.open(url2, "_blank", "noopener");
      }
    });
  </script>
</body>
</html>
